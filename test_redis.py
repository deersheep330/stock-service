import json

import redis
from stock.utilities import get_redis_host

if __name__ == '__main__':

    r = redis.Redis(host=get_redis_host(), port=6379, db=0)

    data = [{"symbol":"2609","name":"陽明","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,1831,1248,1411,1003,602,302,1957,1044,1774,1057,1116,697,379],"prices":[0,216.5,210.0,216.5,195.5,0,0,195.5,176.0,163.0,179.0,188.0,188.0,188.0],"total_popularity":14421},{"symbol":"2603","name":"長榮","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,1582,1635,1571,1115,272,518,785,1203,1836,1354,1098,510,112],"prices":[0,224.0,202.0,207.5,187.0,0,0,183.0,165.0,148.5,163.0,178.5,178.5,178.5],"total_popularity":13591},{"symbol":"2330","name":"台積電","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,283,190,159,375,451,430,339,536,296,984,873,223,220],"prices":[0,592.0,594.0,0,584.0,0,0,593.0,607.0,613.0,614.0,589.0,589.0,589.0],"total_popularity":5359},{"symbol":"2615","name":"萬海","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,717,458,886,762,44,432,194,116,513,314,345,268,17],"prices":[0,0,276.5,304.0,275.0,0,0,287.0,258.5,253.5,278.5,286.0,286.0,286.0],"total_popularity":5066},{"symbol":"2002","name":"中鋼","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,382,543,127,511,297,27,387,263,244,305,344,365,32],"prices":[0,0,0,38.75,38.05,0,0,37.9,36.5,35.9,37.0,36.35,36.35,36.35],"total_popularity":3827},{"symbol":"2614","name":"東森","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,28,72,74,190,19,167,526,224,98,110,208,324,608],"prices":[0,48.9,53.7,0,59.0,0,0,64.9,69.3,62.4,56.2,50.6,50.6,50.6],"total_popularity":2648},{"symbol":"NWSA","name":"新聞","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,77,105,68,116,56,59,85,83,132,83,114,75,64],"prices":[0,0,25.54,24.85,24.8,25.52,0,0,25.83,25.23,25.0,24.91,24.22,24.22],"total_popularity":1117},{"symbol":"2027","name":"大成鋼","dates":["2021/07/05","2021/07/06","2021/07/07","2021/07/08","2021/07/09","2021/07/10","2021/07/11","2021/07/12","2021/07/13","2021/07/14","2021/07/15","2021/07/16","2021/07/17","2021/07/18"],"popularities":[0,242,83,188,32,165,0,47,179,26,55,38,10,17],"prices":[0,59.5,57.1,0,56.9,0,0,59.6,56.3,54.4,58.5,58.3,58.3,58.3],"total_popularity":1082}]

    str_data = json.dumps(data)

    print(r.set('foo', str_data))
    print(json.loads(r.get('foo'))[0])
